{% load mathfilters %}
<link rel="stylesheet" href="../../static/css/newsfeed.css">
<p>
	<div id="Newsfeed" class="tabcontent">
		<div id="News" class="news">
			<form action="{% url 'home' %}" id="add_post_form" class="add_post_form" method="POST">
				{% csrf_token %}
				<div class="form-content">
					{{ form }}
				</div>
				<div class="add_post_btn_container">
					<input id="add_post_btn" class="add_post_btn" type="submit" value="Post">
				</div>
			</form>

			<div class="newsfeed_posts">
				{% for post in post_list %}
					<div class="newsfeed_post">
						<div class="post_header">
							On {{ post.published_date }} {{ post.author }} said:
						</div>
						<div class="post_content">
							 {{ post.text }}
						</div>
					</div>
				{% endfor %}
			</div>
		</div>

		<div id="Polls" class="polls">
			<div class="poll_posts">
				{% for poll_question, poll_choices in poll_dict.items %}
					{% if poll_question in freezed_questions %}
					<form class="poll_post" method="POST">
						<fieldset disabled>
							{% csrf_token %}
							<div>
								Until {{ poll_question.due_date }} you should answer to the following poll: <br>
								<br>
							</div>

							{{poll_question.question_text}} <br>
							<br>
							{% for choice in poll_choices %}
								{% if choice in voted_choices %}
									<input type="radio" name="choice" value="{{choice.id}}" checked> {{choice.text}} {{ choice.number_of_votes|div:number_of_users|mul:100 }}% 
								{% else %}
									<input type="radio" name="choice" value="{{choice.id}}"> {{choice.text}} {{ choice.number_of_votes|div:number_of_users|mul:100 }}%
								{% endif %}
								<br>
								<br>
							{% endfor %}
							<input type="submit" name="submit_poll_answer" value="Submit">
						</fieldset>
					</form>
					{% else %}
						<form class="poll_post" method="POST">
							{% csrf_token %}
							<div>
								Until {{ poll_question.due_date }} you should answer to the following poll: <br>
								<br>
							</div>

							{{poll_question.question_text}} <br>
							<br>
							{% for choice in poll_choices %}
								<input type="radio" name="choice" value="{{choice.id}}"> {{choice.text}} <br>						
								<br>
							{% endfor %}
							<input type="submit" name="submit_poll_answer" value="Submit">
						</form>
					{% endif %}
				{% endfor %}
			</div>
		</div>

		<br style="clear:both;"/>
	</div>
	<script type="text/javascript">
		$('#add_post_btn').mousedown(function(e){
    	    e.preventDefault();
    	});
		$("textarea[name='text']").focus(function(){
    		$(this).attr('rows',3);
    		$("#add_post_btn").show();
  			}).blur(function(){
  				$(this).val('');
				$(this).attr('rows',1);
				$("#add_post_btn").hide();
  			});
	</script>
</p>
